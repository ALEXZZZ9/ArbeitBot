Фриланс-Бот

Главная идея: биржа фриланса наоборот!

Техническая часть:
============================================================
! - Добавить методы в dbmanager.js для работы с другими моделями
! - Написать FSM для перехода между кнопками в сессиях
	- после опубликования заказа и выбора первых фрилансеров - создается запись в коллекции sessions
	- используется для обработки кнопок до конца заключения сделки
	Логика работы FSM: 
		Вход: текст последней нажатой кнопки (или callback_data) - идет проверка на сюществование пары (Кнопка,chat_id) в sessions, если есть, то идем по условию, 
			  если нет, то либо сообщение, типа "неверная команда", либо ничего
		Условие: текст нажатой сейчас кнопка (или callback_data) - 
		Переход: переходим по FSM таблице в следущее состояние 

!	Структура таблицы FSM (FSMTable - хранится в БД):

						"Условие1" 		"Условие2"		...	"УсловиеN"		"Default"
		"Текст_Входа1": "Состояние1_1"	"Состояние1_2"		"Состояние1_N"	"Состояние1_Default"
		"Текст_Входа2":	"Состояние2_1"	"Состояние2_2"		"Состояние2_N"	"Состояние2_Default"
			...				...				...			...		...					...	
		"Текст_Входа3":	"СостояниеN_1"	"СостояниеN_2"	...	"СостояниеN_N"	"СостояниеN_Default"

		Где, "СостояниеA_B" - {
								"keyboard": keyboardObject, 				// default []
							   	"inline_keyboard": inlineKeyboardObject,	// default []
							   	"method": telegramMethod,					// какой метод использовать
							   	"method_params": jsonObject,				// параметры метода - их дефолтные значения, который мы переопределим, если надо
							   	"callback": callbackFunctionFSM				// функция для обработки перехода (записать что в БД, извлечь, 
							   												// подготовить параметры для отправки) 
							   }

		Где, callbackFunctionFSM:
		function callbackFunctionFSM(telegram_update) {
			// work with DB
				...
				// записать в sessions новое значение last_text

			method_params = FSMTable("method_params");
			// format method_params
			
			bot[FSMTable("method")](method_params)
			.catch(err => console.log(err));
		}

!	Структура коллекции sessions:
		{
			last_text: String,			// по обычной кнопке или callback_data
			freelancer_id: Number,		// bot DB id of user			
			jobs: [{					// список работ, которые заказчики предлагают
			    type: Schema.ObjectId,
			    ref: 'job',
			    required: false,
			    default: []
			}]
		}

- 	На вебхуки переписать



Logic:
============================================================
[] – button
[[]] – button collection
============================================================

/start
===========================
	> What are you looking for?
	< [Freelancers][Work]

[Freelancers]
===========================
! - добавить заказ
	!- введите название проекта
	!- ввежите описание проекта
	!- введите категории проекта - из списка, можно добавить свою 
	    - продумать как модерировать
	!- введите стоимость ОТ/ДО
	    - за час, за проекта
- получить список свободных кандидатов - 
!    - добавить статус, рейтинг в модель freelancer
!    - предусмотреть возможность отображать фуллнейм и писать человеку без юзернама - вплоть до подтверждения фрилансером работы, показаны bot_username`s
    список инлайн кнопок с юзернеймами фрилансеров "@username -" - внизу обычная кнопка - "Отправить всем", "Завершить поиск"
    - показывать их псевдонимы из биржи!!!
    - возможность сортировать кандидатов, по: рейтингу, времени в боте, стоимости, еще?
- при клике на инлайн кнопку фрилансера ему отправляется уведомление, что его выбрали и он должен либо подтвердить, либо отказаться
- если, фрилансер откликнулась, то кнопка меняется на "@username +" и заказчику присылается уведомление
    - при ответе фрилансера учитывать действует ли еще заявка - не выбран ли исполнитель
- ["Отправить всем"] - тоже самое, но всем
- тех заказчиков, что откликнулись можно выбрать и написать им
- ["Завершить поиск"] - фрилансерам, кому отправил инвайт заказчик, отправляется отмена, в базу /job сохраняется заказ, конец 


[Work]
===========================
if freelancer didn't fill below data yet
	> Please select a category that fits you the best
	< [html5][javascript][nodejs]...
	===
	> Please write a small (250 characters) description about yourself (will be visible to clients)
	< (small description within 250 chars)
	===
	> Please give us your average hourly rate in USD so that we can give you better offers
	< [$5...$10][$10...$20]...
	===
	> You rock! Now just wait for us to send you matching job offers or browse through the menu
	< [[Freelancer main menu]]
else
	> You rock! Now just wait for us to send you matching job offers or browse through the menu
	< [[Freelancer main menu]]

[[Freelancer main menu]]
===========================
[Ready to work]\[Busy] (depends on 'busy' flag of freelancer)
[Change categories]
[Change bio]
[Change hourly rate]
[Help]
===========================

[Ready to work]
===========================
	> You are now busy. You will not receive any job offers untill you switch back to "Ready to work"
	< [[Freelancer main menu]]

[Busy]
===========================
	> You are now ready to work. You will  receive job offers untill you switch back to "Busy"
	< [[Freelancer main menu]]

[Change categories]
===========================
	> Please select categories that match your skillset:
	< [html5][javascript][nodejs]... <- inline keyboard where yeach category can be selected\deselected
	(freelancer main menu is still there)

[Change bio]
===========================
	> Here is your existing bio: <description>. What would you like us to change it to?
	< (small description within 250 chars)
	===
	> You rock! Your bio has been updated
	< [[Freelancer main menu]]

[Change hourly rate]
===========================
	> You current hourly rate is: <hourly rate>. What would you like us to change it to?
	< [$5...$10][$10...$20]...
	 ===
	> You rock! Your hourly rate has been updated
	< [[Freelancer main menu]]

[Help]
===========================
	> Please contact us if you have any questions at all
	< [@borodutch] <- inline keyboard
	(freelancer main menu is still there)